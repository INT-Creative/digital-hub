---
export interface Props {
  platform?: 'twitter' | 'linkedin' | 'instagram';
  count?: number;
  showProfile?: boolean;
  className?: string;
}

const { 
  platform = 'twitter', 
  count = 3,
  showProfile = true,
  className = ''
} = Astro.props;

import { SOCIAL_CONFIG } from '../../config/social.ts';

// Mock social media posts - in production, these would come from social media APIs
const mockPosts = {
  twitter: [
    {
      id: 1,
      author: '@intcreative',
      content: "Just helped another startup increase their lead generation by 340% in 8 weeks ðŸš€ The secret? Data-driven customer persona mapping + optimized landing pages. #startup #leadgen #marketing",
      timestamp: '2h',
      likes: 24,
      retweets: 8,
      engagement: 32
    },
    {
      id: 2,
      author: '@intcreative',
      content: "PSA for early-stage founders: Your marketing budget should be 15-20% of revenue, but if you're pre-revenue, focus on organic growth strategies first. Build audience â†’ validate â†’ monetize. #startups",
      timestamp: '1d',
      likes: 56,
      retweets: 23,
      engagement: 79
    },
    {
      id: 3,
      author: '@intcreative',
      content: "Case study drop ðŸ“Š How we helped @TechStartupX grow from 0 to 10K qualified leads in 6 months using a combination of content marketing, SEO, and targeted paid ads. Thread below ðŸ‘‡",
      timestamp: '3d',
      likes: 89,
      retweets: 45,
      engagement: 134
    }
  ],
  linkedin: [
    {
      id: 1,
      author: 'INT Creative',
      content: "The biggest mistake we see startups make with their marketing? Trying to be everything to everyone. Niche down, dominate your corner of the market, then expand. Your CAC will thank you.",
      timestamp: '4h',
      likes: 67,
      comments: 12,
      engagement: 79
    },
    {
      id: 2,
      author: 'INT Creative',  
      content: "Founders: Stop guessing what your customers want. Here's our 3-step validation framework that's helped 50+ startups avoid product-market fit disasters...",
      timestamp: '2d',
      likes: 134,
      comments: 28,
      engagement: 162
    },
    {
      id: 3,
      author: 'INT Creative',
      content: "Marketing attribution for startups doesn't have to be complex. Focus on these 3 metrics: 1) Customer Acquisition Cost (CAC) 2) Lifetime Value (LTV) 3) Time to Payback. Everything else is noise.",
      timestamp: '5d',
      likes: 92,
      comments: 18,
      engagement: 110
    }
  ],
  instagram: [
    {
      id: 1,
      author: '@intcreative',
      content: "Behind the scenes: Strategy session with a SaaS startup that went from $0 to $1M ARR in 18 months ðŸ“ˆ Swipe to see the growth framework we used",
      timestamp: '6h',
      likes: 234,
      comments: 45,
      engagement: 279
    },
    {
      id: 2,
      author: '@intcreative',
      content: "Startup marketing tip: Your website homepage should answer 3 questions in 5 seconds: 1) What do you do? 2) Who is it for? 3) What's in it for me? That's it.",
      timestamp: '1d',
      likes: 187,
      comments: 23,
      engagement: 210
    },
    {
      id: 3,
      author: '@intcreative',
      content: "Coffee chat insights â˜• Talked to 10 startup founders this week. The common thread? They all wish they'd started marketing earlier. Don't wait for product perfection.",
      timestamp: '4d',
      likes: 156,
      comments: 34,
      engagement: 190
    }
  ]
};

const posts = mockPosts[platform] || mockPosts.twitter;
const platformConfig = {
  twitter: {
    name: 'Twitter',
    url: SOCIAL_CONFIG.urls.twitter,
    color: 'text-blue-500',
    bgColor: 'bg-blue-50',
    icon: 'twitter'
  },
  linkedin: {
    name: 'LinkedIn',
    url: SOCIAL_CONFIG.urls.linkedin, 
    color: 'text-blue-700',
    bgColor: 'bg-blue-50',
    icon: 'linkedin'
  },
  instagram: {
    name: 'Instagram',
    url: SOCIAL_CONFIG.urls.instagram,
    color: 'text-pink-600',
    bgColor: 'bg-pink-50', 
    icon: 'instagram'
  }
};

const currentPlatform = platformConfig[platform];
---

<div class={`social-feed ${className}`}>
  {showProfile && (
    <div class="flex items-center justify-between mb-6">
      <div class="flex items-center space-x-3">
        <div class={`w-10 h-10 ${currentPlatform.bgColor} rounded-full flex items-center justify-center`}>
          {platform === 'twitter' && (
            <svg class={`w-5 h-5 ${currentPlatform.color}`} fill="currentColor" viewBox="0 0 24 24">
              <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
            </svg>
          )}
          
          {platform === 'linkedin' && (
            <svg class={`w-5 h-5 ${currentPlatform.color}`} fill="currentColor" viewBox="0 0 24 24">
              <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
            </svg>
          )}
          
          {platform === 'instagram' && (
            <svg class={`w-5 h-5 ${currentPlatform.color}`} fill="currentColor" viewBox="0 0 24 24">
              <path d="M12.017 0C8.396 0 7.989.016 6.756.072 5.526.127 4.718.372 4.037.7c-.707.275-1.305.646-1.901 1.244-.596.598-.969 1.195-1.244 1.902C.372 4.718.127 5.526.072 6.756.016 7.989 0 8.396 0 12.017c0 3.624.016 4.031.072 5.264.055 1.23.3 2.038.628 2.719.275.707.646 1.305 1.244 1.901.598.596 1.195.969 1.902 1.244.681.328 1.489.573 2.719.628 1.233.056 1.64.072 5.264.072 3.624 0 4.031-.016 5.264-.072 1.23-.055 2.038-.3 2.719-.628.707-.275 1.305-.646 1.901-1.244.596-.598.969-1.195 1.244-1.902.328-.681.573-1.489.628-2.719.056-1.233.072-1.64.072-5.264 0-3.624-.016-4.031-.072-5.264-.055-1.23-.3-2.038-.628-2.719-.275-.707-.646-1.305-1.244-1.901C19.06.646 18.463.275 17.756 0 17.075-.328 16.267-.573 15.037-.628 13.804-.684 13.397-.7 9.773-.7s-4.031.016-5.264.072zm-.117 21.674c-3.365 0-3.739-.015-5.048-.069-1.206-.054-1.86-.259-2.294-.429-.576-.224-.987-.49-1.42-.923-.432-.433-.7-.844-.923-1.42-.17-.434-.375-1.088-.429-2.294-.054-1.309-.069-1.683-.069-5.048s.015-3.739.069-5.048c.054-1.206.259-1.86.429-2.294.224-.576.49-.987.923-1.42.433-.432.844-.7 1.42-.923.434-.17 1.088-.375 2.294-.429C8.375.085 8.749.07 12.114.07s3.739.015 5.048.069c1.206.054 1.86.259 2.294.429.576.224.987.49 1.42.923.432.433.7.844.923 1.42.17.434.375 1.088.429 2.294.054 1.309.069 1.683.069 5.048s-.015 3.739-.069 5.048c-.054 1.206-.259 1.86-.429 2.294-.224.576-.49.987-.923 1.42-.433.432-.844.7-1.42.923-.434.17-1.088.375-2.294.429-1.309.054-1.683.069-5.048.069z"/>
            </svg>
          )}
        </div>
        
        <div>
          <h3 class="font-semibold text-gray-900">Latest from {currentPlatform.name}</h3>
          <p class="text-sm text-gray-600">@intcreative</p>
        </div>
      </div>
      
      <a 
        href={currentPlatform.url}
        target="_blank"
        rel="noopener noreferrer"
        class={`${currentPlatform.color} hover:underline text-sm font-medium transition-colors duration-200`}
      >
        Follow us â†’
      </a>
    </div>
  )}
  
  <div class="space-y-4">
    {posts.slice(0, count).map((post) => (
      <div key={post.id} class="bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow duration-200">
        <div class="flex items-start space-x-3">
          <div class={`w-8 h-8 ${currentPlatform.bgColor} rounded-full flex items-center justify-center flex-shrink-0`}>
            <span class="text-xs font-medium text-gray-700">IC</span>
          </div>
          
          <div class="flex-1">
            <div class="flex items-center space-x-2 mb-2">
              <span class="font-medium text-gray-900">{post.author}</span>
              <span class="text-gray-500">â€¢</span>
              <span class="text-sm text-gray-500">{post.timestamp}</span>
            </div>
            
            <p class="text-gray-700 text-sm leading-relaxed mb-3">
              {post.content}
            </p>
            
            <div class="flex items-center space-x-4 text-xs text-gray-500">
              {platform === 'twitter' && (
                <>
                  <div class="flex items-center space-x-1">
                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                    </svg>
                    <span>{post.likes}</span>
                  </div>
                  <div class="flex items-center space-x-1">
                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                    </svg>
                    <span>{post.retweets}</span>
                  </div>
                </>
              )}
              
              {platform === 'linkedin' && (
                <>
                  <div class="flex items-center space-x-1">
                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V5a2 2 0 00-2-2H4.5a2.5 2.5 0 000 5H7m7-10v4.5"/>
                    </svg>
                    <span>{post.likes}</span>
                  </div>
                  <div class="flex items-center space-x-1">
                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                    </svg>
                    <span>{post.comments} comments</span>
                  </div>
                </>
              )}
              
              {platform === 'instagram' && (
                <>
                  <div class="flex items-center space-x-1">
                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                    </svg>
                    <span>{post.likes}</span>
                  </div>
                  <div class="flex items-center space-x-1">
                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                    </svg>
                    <span>{post.comments}</span>
                  </div>
                </>
              )}
            </div>
          </div>
        </div>
      </div>
    ))}
  </div>
  
  <div class="text-center mt-6">
    <a 
      href={currentPlatform.url}
      target="_blank"
      rel="noopener noreferrer"
      class={`inline-flex items-center space-x-2 ${currentPlatform.color} hover:underline text-sm font-medium transition-colors duration-200`}
    >
      <span>View more on {currentPlatform.name}</span>
      <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/>
      </svg>
    </a>
  </div>
</div>

<style>
  .social-feed {
    /* Add any custom styles for the social feed */
  }
  
  .social-feed .hover\:shadow-md:hover {
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  }
</style>

<script>
  // Track social media feed interactions
  document.addEventListener('DOMContentLoaded', function() {
    const feedLinks = document.querySelectorAll('.social-feed a[target="_blank"]');
    
    feedLinks.forEach(link => {
      link.addEventListener('click', function() {
        const platform = this.href.includes('linkedin') ? 'linkedin' : 
                        this.href.includes('twitter') ? 'twitter' :
                        this.href.includes('instagram') ? 'instagram' : 'unknown';
        
        // Track social media clicks
        if (typeof gtag !== 'undefined') {
          gtag('event', 'social_feed_click', {
            platform: platform,
            source: 'social_feed_widget'
          });
        }
      });
    });
  });
</script>